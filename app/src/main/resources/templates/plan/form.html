<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>모여</title>

  <!-- 네이버 지도 API -->
  <!--<script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=fjpvq7xa56"></script>-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
  <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=fjpvq7xa56&submodules=geocoder"></script>
  <script  src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script type="text/javascript" src="http://code.jquery.com/jquery-2.2.4.min.js"></script>
  <!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->

  <!-- include libraries(jQuery, bootstrap) -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <!-- include summernote css/js -->
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>

  <style>
    body {
        padding-left: 10px;
    }
  </style>

  <link href="/webjars/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <script src="/webjars/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<div data-th-replace="header :: header">머리말</div>

<form action="add" data-th-action="@{add}" method='post' enctype='multipart/form-data'>
  <input data-th-value="${recruitBoardId}" name='recruitBoardId' type='hidden'>
  <div>
    제목: <input name='title' type='text'>
  </div>
  <div>
    여행일자: <input name="tripDate" type="date">
  </div>
  <div>
    여행순서: <input name="tripOrder" type="number">
  </div>
  <div>
    내용: <textarea name='content' type="text" id="summernote"></textarea>
  </div>
  <div>
    <button>등록</button>
  </div>
</form>
  <script>
    $(document).ready(function() {

      $('#summernote').summernote({
        height: 300,
        width: 500,

        callbacks: {
          onInit: function() {
            console.log('Summernote 생성됨!');
          },
          onImageUpload: function(photos) {
            let data = new FormData();
            for (const photo of photos) {
              data.append("photos", photo);
            }
            $.ajax({
              url: 'photo/upload',
              type: 'POST',
              dataType: 'json',
              contentType: false,
              processData: false,
              data: data
            })
            .done(function(result) {
              for (const planPhoto of result) {
                $('#summernote').summernote('insertImage',
                  'https://kr.object.ncloudstorage.com/moyeo-bucket/plan/'
                  + planPhoto.photo);
              }
            });
          }
        }
      });
    });
  </script>
</body>
<div data-th-replace="footer :: footer">꼬리말</div>
</html>