<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <title>모여</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/webjars/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <script src="/webjars/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>

  <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <!-- include summernote css/js -->
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>

  <style>
    body {
      padding-left: 10px;
    }
  </style>
</head>
<body  data-th-object="${recruitboard}">

<div data-th-replace="header :: header">머리말</div>

<form action="update" data-th-action="@{updateForm}"
      enctype='multipart/form-data' method='post'>
  <div>
    번호: <input data-th-value="*{recruitBoardId}" readonly name='recruitBoardId' type='text' value='100'>
  </div>
  <div>
    제목: <input data-th-value="*{title}" readonly name='title' type='text' value="제목입니다.">
  </div>
  <div>
    지역: <input data-th-value="*{region.regionName}" readonly type='text' value="서울특별시">
  </div>
  <div>
    내용: <textarea id="summernote" data-th-text="*{content}" readonly name='content' style="display: none;"></textarea>
  </div>
  <div>
    작성일: <input name="createdDate" data-th-text="${#dates.format(createdDate,'yyyy-MM-dd')}" readonly
                type='text' value="2024-03-27">
  </div>
  <div>
    상태: <input data-th-value="*{state}" readonly type='text' name="state">
  </div>
  <div>
    위도: <input data-th-value="*{latitude}" readonly type='text' name="latitude">
  </div>
  <div>
    경도: <input data-th-value="*{longitude}" readonly type='text' name="longitude">
  </div>
  <div>
    조회수: <input data-th-value="*{views}" readonly type='text' name="views">
  </div>

  <div>
    <button>수정</button>
    [<a data-th-href="@{delete(recruitBoardId=*{recruitBoardId})}" href="delete.html">삭제</a>]
    [<a data-th-href="@{../recruitScrap/add(recruitBoardId=*{recruitBoardId})}" href="scrap.html">즐겨찾기</a>]
    [<a data-th-href="@{../recruitMember/add(recruitBoardId=*{recruitBoardId})}" href="apply.html">신청하기</a>]
  </div>
</form>

<div>
  <div>
    댓글
    <ul data-th-if="*{comments}">
      <li data-th-each="comment : *{comments}" data-th-object="${comment}">
        <div id="commentviewform">
          <input data-th-value="*{recruitCommentId}" type="hidden"/>
          프로필사진: <input data-th-value="*{member.photo}" readonly type='text' value="프사"/>
          작성자: <input data-th-value="*{member.nickname}" readonly type='text' value="닉네임"/>
          내용: <input id="commentcontent" data-th-value="*{content}" readonly type='text' value="내용"/>
          작성일: <input data-th-text="${#dates.format(createdDate,'yyyy-MM-dd')}" readonly
                      type='text' value="2024-04-03"/>
          <button id="editBtn">수정</button>
          <a id="deletecomment" data-th-href="@{comment/delete(recruitCommentId=*{recruitCommentId})}"
             href="delete.html" onclick="alert('삭제했습니다.')">삭제</a>
        </div>
        <form id="updatecomment" data-th-action="@{/recruit/comment/update}"
              action="view.html" method='post' style="display:none;">
          <div id="updateform" data-th-replace="recruit/commentform :: recruitcommentupdate"></div>
        </form>
        <button id="cancelBtn" style="display: none;" onclick="cancelEdit()">취소</button>
      </li>
    </ul>
  </div>

  <form data-th-action="@{/recruit/comment/add}" action="view.html" data-th-object="${loginUser}" method='post'>
    <input data-th-value="${recruitboard.recruitBoardId}" name='recruitBoardId' type="hidden">
    프로필사진: <input data-th-value="*{photo}" readonly type='text'/>
    작성자: <input data-th-value="*{name}" name="name" readonly type='text'/>
    내용: <textarea id="content" name="content" type="text"></textarea>
    <button id="submit">전송</button>
  </form>
</div>

</body>
<div data-th-replace="footer :: footer">꼬리말</div>

<script>


  // editBtn 클릭 시 실행될 함수
  function editComment() {
    // 클릭된 editBtn 요소의 부모 요소인 li 태그 선택
    var listItem = event.target.closest("li");

    var commentViewForm = listItem.querySelector("#commentviewform");
    var updateCommentForm = listItem.querySelector("#updatecomment");
    var cancelBtn = listItem.querySelector("#cancelBtn");
    var submitBtn = listItem.querySelector("#submitBtn");

    // commentViewForm-> none, updateCommentForm/cancelBtn-> block
    commentViewForm.style.display = "none";
    updateCommentForm.style.display = "block";
    cancelBtn.style.display = "block";

    // 전송 버튼에 클릭 이벤트 추가
    submitBtn.addEventListener("click", function() {
      commentViewForm.style.display = "block";
      updateCommentForm.style.display = "none";
      cancelBtn.style.display = "none";
    });

    // 취소 버튼에 클릭 이벤트 추가
    cancelBtn.addEventListener("click", function() {
      commentViewForm.style.display = "block";
      updateCommentForm.style.display = "none";
      cancelBtn.style.display = "none";
    });
  }

  // 모든 editBtn 요소 찾기
  var editBtns = document.querySelectorAll("#editBtn");

  // 각 editBtn에 대해 이벤트 리스너 추가
  editBtns.forEach(function(btn) {
      btn.addEventListener("click", editComment);
  });

  // summernote 사용 설정
  $(document).ready(function() {
    var options = new Object();
    options.height = 300;
    options.width = 900;

    $('#summernote').summernote(options).summernote("disable");
  });

</script>
</html>