<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <title>모여</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bootstrap core CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
        rel="stylesheet">
  <!-- JQuery -->
  <script  src="http://code.jquery.com/jquery-latest.min.js"></script>

  <style>
    aside #recruitTheme {
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      width: 500px;
      margin-right: 35px;
    }
    aside #recruitTheme li{
      margin-left: 10px;
      margin-right: 10px;
    }
    aside #recruitRegion li {
      margin-top: 10px;
      margin-right: 50px;
      margin-bottom: 10px;
    }
  </style>
</head>

<body>

<div class="container-fluid">

  <!-- 헤더 -->
  <div class="row sticky-top">
    <div data-th-replace="header :: header">머리말</div>
  </div>

  <!-- 컨텐트 -->
  <div class="d-flex p-3 justify-content-center align-items-start vh-100">

    <!-- 지역, 테마 -->
    <div class="d-flex justify-content-end" style="width:300px;">
      <div fName="regionTheme" class="border d-flex mx-2">
        <div class="m-2">
          <div data-th-replace="recruit/recruitRegionTest :: recruitRegionList">
            지역
          </div>
        </div>
      </div>
    </div>

    <!-- 게시판 -->
    <div class="d-flex flex-column border p-2 col-7">

      <p class="text-center fs-2 fw-bold pt-4 pb-3">멤버 모집게시판</p>

      <!-- 지역, 테마 -->
      <div class="d-flex justify-content-center">
        <div fName="regionTheme" class="d-flex mx-2">
          <div class="m-2">
            <div class="recruitThemeList" data-th-replace="recruit/recruitThemeTest :: recruitThemeList">
              테마
            </div>
          </div>
        </div>
      </div>

      <!-- 리스트 -->
      <table class="table table-striped table-hover table-bordered">
        <thead>
        <tr>
          <th class="col-1 text-center">번호</th>
          <th class="col-4 text-center">제목</th>
          <th class="col-1 text-center">작성자</th>
          <th class="col-1 text-center">모집현황</th>
          <th class="col-1 text-center">모집상태</th>
          <th class="col-1 text-center">작성일자</th>
          <th class="col-1 text-center">조회수</th>
        </tr>
        </thead>
        <tbody>
        <tr data-th-each="recruitboard : ${list}" data-th-object="${recruitboard}">
          <td class="text-center" data-th-text="*{recruitBoardId}">1</td>
          <!--son, 04.09 , data-th-href를 viewCountUp으로 요청하게 끔 변경.-->
          <!-- viewCountUp에서 조회수를 증가시키고 view페이지로 리다이렉트하게끔 함 -->
          <td class="text-center"><a data-th-href="@{viewCountUp(recruitBoardId=*{recruitBoardId})}"
                 data-th-text="*{title}" href="view.html">제목입니다</a></td>
          <td class="text-center" data-th-text="*{writer.nickname}">홍길동</td>
          <td class="text-center" data-th-text="|*{current} / *{recruitTotal}|">1 / 4</td>
          <td class="text-center" data-th-if="*{state == true}">모집중</td> <!--data-th-value => data-th-text -->
          <td class="text-center" data-th-if="*{state == false}">모집완료</td> <!--data-th-value => data-th-text -->
          <td class="text-center" data-th-text="*{#dates.format(createdDate,'yyyy-MM-dd')}">2024-04-02</td>
          <!--data-th-value => data-th-text -->
          <td class="text-center" data-th-text="*{views}">12</td>
        </tr>
        </tbody>
      </table>

      <!-- 페이징 -->
      <div class="d-flex justify-content-center py-3">
        <nav aria-label="Page navigation">
          <ul class="pagination">
            <li class="page-item disabled" data-th-if="${pageNo <= 1}"><a
                class="page-link">Previous</a></li>
            <li class="page-item"><a class="page-link"
                                     data-th-href="@{list(pageNo=${pageNo - 1},pageSize=${pageSize},regionId=${regionId},themeId=${themeId},filter=${filter}, keyword=${keyword})}"
                                     data-th-if="${pageNo > 1}">Previous</a></li>
            <!-- 반복(th-each)을 돌면서 페이지 버튼을 만듦. -->
            <li class="page-item" data-th-each="pageButton : ${pageButtons}" data-th-id="page+${pageButton}"><a class="page-link"
                href="#"
                data-th-href="@{list(pageNo=${pageButton},pageSize=${pageSize},regionId=${regionId},themeId=${themeId},filter=${filter}, keyword=${keyword})}"
                data-th-text="${pageButton}"></a>
            </li>
            <li data-th-if="${pageNo >= numOfPage}" class="page-item disabled"><a class="page-link">Next</a>
            </li>
            <li data-th-if="${pageNo < numOfPage}" class="page-item"><a class="page-link"
                                                                        data-th-href="@{list(pageNo=${pageNo + 1},pageSize=${pageSize},regionId=${regionId},themeId=${themeId},filter=${filter}, keyword=${keyword})}">Next</a>
            </li>
          </ul>
        </nav>
      </div>

      <!-- 검색 및 글쓰기 -->
      <div class="d-flex flex-row justify-content-between pb-3">
        <div style="width: 50px"></div>
        <div class="">
          <form method="get" action="list.html" data-th-action="@{list}">
            <input type="hidden" name="regionId" data-th-value="${regionId}">
            <input type="hidden" name="themeId" data-th-value="${themeId}">
            <label for="filter"></label>
            <select name="filter" id="filter">
              <option value="title">제목</option>
              <option value="content">내용</option>
              <option value="nickname">작성자</option>
            </select>
            <input type="text" name="keyword" data-th-value="${keyword}">
            <input type="submit" data-th-value="검색">
          </form>
        </div>
        <div class="mx-2" style="width: 50">
          <a data-th-href="@{/recruit/addForm}" href="form">새 과제</a>
        </div>
      </div>
    </div><div style="width:300px;">
    </div>
  </div>

  <!-- 푸터 -->
  <div class="row sticky-bottom">
    <div data-th-replace="footer :: footer">꼬리말</div>
  </div>
</div>
</body>

</html>

<!-- 부트스트랩 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- 검색 필터 기본값 설정 자바 스크립트 -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
  let dropdown = document.getElementById("filter");
  let condition = "[[${filter}]]";

  switch (condition) {
    case "title":
      dropdown.value = "title";
      break;
    case "content":
      dropdown.value = "content";
      break;
    case "nickname":
      dropdown.value = "nickname";
      break;
    default:
      dropdown.value = "title";
      break;
  }
});
</script>

<script>
  $(document).ready(function() {

    /* 현재 페이지에 해당하는 페이지 버튼을 찾아서 그 버튼의 클래스에 active를 추가,
    현재 페이지가 어디인지 시각적으로 보이게 함. */
    var link = document.getElementById("page[[${pageNo}]]");
    console.log(link);
    link.classList.add('active');
  })
</script>